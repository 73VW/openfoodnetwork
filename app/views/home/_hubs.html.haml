= inject_enterprises

#hubs.hubs{"ng-controller" => "EnterprisesCtrl", "ng-cloak" => true}
  .row
    .small-12.columns
      %h1{"scroll-after-load" => (spree_current_user ? true : nil)} Shop in your local area

  = render "shared/components/enterprise_search"
  = render "home/filters"

  .row{bindonce: true}
    .small-12.columns
      .name-matches{"ng-show" => "nameMatches.length > 0"}
        %h2 Did you mean?
        = render "home/hubs_table", enterprises: "nameMatches"

      .distance-matches{"ng-show" => "nameMatches.length == 0 || distanceMatchesShown"}
        %h2
          Closest to
          %span{"ng-show" => "nameMatches.length > 0"} {{ nameMatches[0].name }}...
          %span{"ng-hide" => "nameMatches.length > 0"} {{ query }}...

        = render "home/hubs_table", enterprises: "distanceMatches"

      .show-distance-matches{"ng-show" => "nameMatches.length > 0 && !distanceMatchesShown"}
        %a{href: "", "ng-click" => "showDistanceMatches()"} Show me shops near {{ nameMatches[0].name }}
