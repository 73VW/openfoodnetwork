%nav#filters
  %div#distributor_filter
    %h6.filter_name Shop by Distributor
    %ul.filter_choices
      - order = current_order(false)
      - validator = DistributorChangeValidator.new(order)
      - @distributors.each do |distributor|
        %li.nowrap
          - if order.nil? || validator.can_change_to_distributor?(distributor)
            = link_to distributor.name, [main_app, distributor]
          - elsif order.distributor == distributor
            = link_to distributor.name, [main_app, distributor]
          - else
            %abbr(title="One or more of the products in your cart is not available from this distributor")= distributor.name
      - if @total_distributors > @distributors.count
        - distributors_more = @total_distributors - @distributors.count
        %span.filter_more
          = "#{distributors_more} more..."
    = button_to 'Browse All Distributors', main_app.distributors_enterprises_path, :method => :get
    
  %div#supplier_filter
    %h6.filter_name Shop by Supplier
    %ul.filter_choices
      - @suppliers.each do |supplier|
        %li.nowrap= link_to supplier.name, [main_app, supplier]
      - if @total_suppliers > @suppliers.count
        - suppliers_more = @total_suppliers - @suppliers.count 
        %span.filter_more
          = "#{suppliers_more} more..."
    = button_to 'Browse All Suppliers', main_app.suppliers_enterprises_path, :method => :get
