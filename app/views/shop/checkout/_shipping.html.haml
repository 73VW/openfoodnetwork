%fieldset#shipping
  %accordion-group
    %accordion-heading
      .row
        .large-6.columns
          Shipping 
        .large-6.columns.text-right
          {{ Order.shippingMethod().name }}
    - for ship_method, i in current_distributor.shipping_methods.uniq
      .row
        .large-12.columns
          -#= f.radio_button :shipping_method_id, ship_method.id,
            -#text: ship_method.name,
            -#"ng-change" => "shippingMethodChanged()",
            -#"ng-model" => "order.shipping_method_id"
          %label
            = radio_button_tag "order[shipping_method_id]", ship_method.id, false,
              "ng-change" => "order.shippingMethodChanged()",
              "ng-model" => "order.shipping_method_id"
            = ship_method.name

    #distributor_address.panel{"ng-show" => "!order.require_ship_address"}
      = @order.distributor.distributor_info.andand.html_safe
      = @order.order_cycle.pickup_time_for(@order.distributor)
      = @order.order_cycle.pickup_instructions_for(@order.distributor) 

    = f.fields_for :ship_address, @order.ship_address do |sa|

      #ship_address{"ng-show" => "order.require_ship_address"}
        %label
          = hidden_field_tag "order[ship_address_same_as_billing]", "false"
          = check_box_tag "order[ship_address_same_as_billing]", true, @order.ship_address_same_as_billing, 
            "ng-model" => "order.ship_address_same_as_billing"
          Shipping address same as billing address?

        %div.visible{"ng-show" => "!order.ship_address_same_as_billing"}
          .row
            .large-12.columns
              = sa.text_field :address1
          .row

            .large-12.columns
              = sa.text_field :address2

          .row
            .large-6.columns
              = sa.text_field :city
            .large-6.columns
              = sa.select :state_id, @order.shipping_address.country.states.map{|c|[c.name, c.id]}
          .row
            .large-6.columns
              = sa.text_field :zipcode, label: "Postcode"
            .large-6.columns.right
              = sa.select :country_id, available_countries.map{|c|[c.name, c.id]},
                {include_blank: false}
          .row
            .large-6.columns
              = sa.text_field :firstname
            .large-6.columns
              = sa.text_field :lastname
          .row
            .large-6.columns
              = sa.text_field :phone

        #ship_address_hidden{"ng-show" => "order.ship_address_same_as_billing"}
          = sa.hidden_field :address1, "ng-value" => "order.bill_address.address1", 
            "ng-disabled" => "!order.ship_address_same_as_billing"
          = sa.hidden_field :address2, "ng-value" => "order.bill_address.address2",
            "ng-disabled" => "!order.ship_address_same_as_billing"
          = sa.hidden_field :city, "ng-value" => "order.bill_address.city",
            "ng-disabled" => "!order.ship_address_same_as_billing"
          = sa.hidden_field :country_id, "ng-value" => "order.bill_address.country_id",
            "ng-disabled" => "!order.ship_address_same_as_billing"
          = sa.hidden_field :zipcode, "ng-value" => "order.bill_address.zipcode",
            "ng-disabled" => "!order.ship_address_same_as_billing"
          = sa.hidden_field :firstname, "ng-value" => "order.bill_address.firstname",
            "ng-disabled" => "!order.ship_address_same_as_billing"
          = sa.hidden_field :lastname, "ng-value" => "order.bill_address.lastname",
            "ng-disabled" => "!order.ship_address_same_as_billing"
          = sa.hidden_field :phone, "ng-value" => "order.bill_address.phone",
            "ng-disabled" => "!order.ship_address_same_as_billing"
